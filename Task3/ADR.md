### <a name="_b7urdng99y53"></a>**Название задачи: Открытие депозитов онлайн** 
### <a name="_hjk0fkfyohdk"></a>**Автор: Климович С. Л.**
### <a name="_uanumrh8zrui"></a>**Дата: 20.06.2025**
### <a name="_3bfxc9a45514"></a>**Функциональные требования**
Опишите здесь верхнеуровневые Use Cases. Их нужно оформить в виде таблицы с пошаговым описанием:

АБС* - далее будем иметь в виду что заявки нужно хранить вне АБС, в отдельной очереди/журнале/БД.
|**№**|**Действующие лица или системы**|**Use Case**|**Описание**|
| :-: | :- | :- | :- |
|UC1.1|Пользователь, сайт|Витрина продуктов|1. Пользователь видит общее предложение депозитных продуктов.|
|UC1.2|Пользователь, кол-центр, АБС*|Заявка через кол-центр|1. Пользователь отправляет форму с сайта.<br> 2. Специалист кол-центра звонит клиенту и предлагает персональные продукты.<br> 3. Специалист кол-центра подтверждает заявку.<br> 4. Специалист кол-центра отправляет заявку в АБС*.|
|UC1.3|Пользователь, офис, АБС*|Идентификация|1. Менеджер фронт-офиса идентифицирует пользователя.<br> 2. Менеджер фронт-офиса подтверждает заявку в АБС*.<br> 3. Менеджер бэк-офиса подтверждает заявку в АБС.|
|UC2.1|Пользователь, ИБ, СМС-сервис|Авторизация|1. Пользователь логинится в ИБ.<br> 2. СМС-сервис шлет код подтверждения логина.|
|UC2.2|Пользователь, ИБ|Витрина продуктов|1. Пользователь видит персонализированную витрину депозитных продуктов.|
|UC2.3|Пользователь, ИБ, АБС*, СМС-сервис|Заявка через ИБ|1. Пользователь выбирает продукт.<br> 2. Пользователь подтверждает заявку на продукт.<br> 3. СМС-сервис шлет код подтверждения заявки.<br> 4. Заявка передается в АБС*.<br> 5. Менеджер бэк-офиса подтверждает заявку в АБС.|
|UC3|Пользователь, СМС-сервис|Информирование|1. СМС-сервис шлет информацию о результате операции.|

### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**

|**№**|**Требование**|
| :-: | :- |
|U1|Обеспечить удобство интерфейса для пользователей старшей возрастной категории|
|U2|Кешировать справочную информацию для улучшения пользовательского опыта|
|U3|Реализовать CDN и геошардирование по регионам |
|R1|Реализовать многофакторную аутентификация в ИБ|
|R2|Реализовать шифрование передаваемых данных|
|R3|Обеспечить обезличивание, сохранность и безопасность персональных данных|
|R4|Обеспечить доступность сайта, интернет-банка и АБС 24/7 99.9% времени|
|P1|Реализовать нагрузочное тестирование ИБ|
|P2|Реализовать обработку и хранение очереди заявок вне АБС|
|P3|Время отклика сайта и интернет-банка порядка милисекунд|
|S1|Документировать создаваемую микросервисную архитектуру и протоколы аудита безопасности|
|+R|Реализовать очередь заявок вне АБС|

### <a name="_qmphm5d6rvi3"></a>**Решение**

[Диаграмма контекста](https://github.com/Boropwnz/architecture-standart/blob/standart/Task3/context.drawio)

![Диаграмма контекста](https://github.com/Boropwnz/architecture-standart/blob/standart/Task3/context.png)

Красным отмечены to-be взаимодействия.

Полагается что имеющийся функционал ИБ и АБС сохраняется, а новые возможности будут добавляться постепенно, с заменой монолитных решений на более гибкие микросервисные. Ничто не мешает использовать старые и новые решения параллельно на период перехода.

Полагается что микросервисная архитектура ИБ будет развиваться постепенно, с последовательной реализацией кеша заявок, брокера сообщений, микросервисов депозитов (а в будующем и кредитов) и переводом монолитной клиент-серверной архитекруты ИБ на микросервисную.

Полагается что АБС будет постепенно делигировать некоторые свои функции (очередь заявок, рассчет персональных ставок) вовне в отдельные микросервисы.

Стоит продумать переход на более годные к горизонтальному масштабированию решения для БД АБС. Например, перейти на .NET и MS SQL.

[Диаграмма контейнеров](https://github.com/Boropwnz/architecture-standart/blob/standart/Task3/container.drawio)

![Диаграмма контейнеров](https://github.com/Boropwnz/architecture-standart/blob/standart/Task3/container.png)

### <a name="_bjrr7veeh80c"></a>**Альтернативы**
1. Одной из альтернатив является переход на единый стек: на Java с привлечением разработчиков АБС к разработке интернет-банка. 
Так же можно перейти на .NET сделав упор на разработчиках интернет-банка.
2. Другая альтернатива реализации калькулятора ставок в АБС - сделать отдельный микросервис.
3. Стоит изучить вопрос законодательства, какие СУБД допустимы к использованию в РФ.
4. Можно рассмотреть вариант разделения баз данных АБС по категориям пользователей или по категориям продуктов (депозиты, кредиты) и масштабировать АБС его разными инстансами БД с разным набором обслуживаемых пользователей (по регионам, продуктам) или разным набором регионов. Шардировать БД АБС по категориям пользователей или по категориям продуктов (один отдел со своей БД занимается депозитами, другой отдел со своей БД занимается кредитами).
5. Прямая интеграция с ИБ АБС приведет к проблемам с производительностью и надежностью.

**Недостатки, ограничения, риски**

1. Нет должной экспертизы сотрудников в вопросе разработки микросервисов.
2. Возможно придется увольнять/менять часть сотрудников, если будет сделан выбор в пользу единого стека .NET/Java.
3. Потребуется время на обучение экспертизе подключения Kafka.
4. Прямая интеграция с ИБ АБС приведет к проблемам с производительностью и надежностью.
5. Нужно изучить вопрос работы с разными СУБД: использовать слой абстракции над конкретными СУБД в приложениях, разработать парсинг данных между разными СУБД.

